# meteo
Сайт с прогнозом погоды. По запросу выдает почасовую информацию о погоде в городе на 7 дней. Использованы: Python 3.10, Django, pandas, bs4, unittest

## ТЗ
Создать сайт, где пользователь вводит название города и получается прогноз погоды на ближайшее время:
* Дополнительные задачи:
    - [x] Тесты
    - [x] Запуск с помощью Docker (docker compose)
    - [x] При повторном посещении сайта предложение посмотреть погоду, в котором пользователь смотрел ранее
    - [x] Сохранение истории поиска для каждого пользователя
    - [x] API, показывающее статистику по поиску
    - [ ] Автодополнение при вводе города
## Работа сайта:
  * Весь сайт состоит из:
    - Стартовая страница с выводом информации о погоде
    - Точка доступа к API /api/city_search_count/ - возвращает статистику поиска пользователей
  * Если пользователь уже искал какой-то город, то данные об этом хранятся в coockie. доступно последние 5 успешных уникальных запросов
  * Предложение посмотреть погоду о ранее запрашиваемых городах
  * Полученная информация о погоде выводится на 7 дней в табличном варианте, где каждая таблица это определенный день недели с почасовым прогнозом: температура, влажность, скорость ветра
  * Для обработки данных из API использован pandas
  * Координаты для запроса к API парсятся с википедии
  * История успешных запросов пользователей хранится в базе
  * Пользователи сохраняются в бд, каждому генерируется уникальный id с помощью uuid
  * Для аутентификации пользователю отправляют в куки зашифрованный user_id
  * Для views и utils написаны тесты. Они хранятся в weather_forecast.tests
## Возможные улучшения
  * Не все города доступны, можно сделать парсинг координат более гибким или использовать другое API для получения координат по названию города
  * Можно позволить пользователю самому выбирать те параметры погоды, которые его интересуют, сейчас они статические
  * Обработку ошибок с поднятием сообщения об ошибке, его отображения пользователю
## Установка и запуск проекта с помощью docker compose
  Запустите терминал. Проверьте установлен ли Docker
```bash
docker version
```
Если Docker отсутствует, установите его. После проверки запустите.
Клонируйте репозиторий на свое устройство или скачайте на свое устройство другим методом:
```bash
git clone https://github.com/Tenrai-chi/meteo.git
```
В папке weather создайте файл .env. В этом файле создайте ENCRYPTION_KEY и поместите туда ключ Fernet для шифрования.
Для генерации ключа используйте [сайт](https://fernetkeygen.com/) или установите библиотеку cryptography и используйте этот код:
```
from cryptography.fernet import Fernet

fernet_key = Fernet.generate_key()
print(fernet_key.decode())
```
Перейдите в папку weather внутри проекта!
```bash
cd weather
```
Теперь вы можете создать образ
```bash
docker-compose build --no-cache
```
Запустите контейнеры на основе созданного образа. Порт 8080 установлен в docker-compose.yml, но вы можете его изменить.
Флаг -d, если вы хотите запустить тесты в этом же терминале
```bash
docker-compose up
```
Для запуска тестов:
```bash
docker-compose exec django_web python weather/manage.py test weather_forecast.tests
```

Теперь проект работает на вашем [localhost](http://127.0.0.1:8080/)

## Скриншоты:

![шаблон](https://github.com/user-attachments/assets/2eed02ce-0c0b-4235-8781-3ebf6c538e93)

![шаблон 2](https://github.com/user-attachments/assets/76092706-5108-43be-9fb9-964be96cc165)
